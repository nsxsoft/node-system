import Vue from 'vue';
import { MDialog } from '../../components/dialog/dialog';
var confirmInstance = undefined;
export var confirmFunction = function (message, options) {
    if (!confirmInstance) {
        confirmInstance = new MDialog({
            el: document.createElement('div')
        });
        document.body.appendChild(confirmInstance.$el);
    }
    confirmInstance.message = message;
    confirmInstance.okLabel = options && options.okLabel ? options.okLabel : undefined;
    confirmInstance.cancelLabel = options && options.cancelLabel ? options.cancelLabel : undefined;
    return new Promise(function (resolve, reject) {
        var onOk = function () {
            if (confirmInstance) {
                unhook();
            }
            Vue.nextTick(function () {
                resolve();
            });
        };
        var onCancel = function () {
            if (confirmInstance) {
                unhook();
            }
            if (!(options && options.silentCancel)) {
                reject();
            }
        };
        var hook = function () {
            if (confirmInstance) {
                confirmInstance.$on('ok', onOk);
                confirmInstance.$on('cancel', onCancel);
                confirmInstance.$props['open'] = true;
            }
        };
        var unhook = function () {
            if (confirmInstance) {
                confirmInstance.$off('ok', onOk);
                confirmInstance.$off('cancel', onCancel);
                confirmInstance.$props['open'] = false;
            }
        };
        if (confirmInstance) {
            confirmInstance.$nextTick(function () {
                hook();
            });
        }
        else {
            console.error('No instance of dialog');
            reject();
        }
    });
};
var ConfirmPlugin = {
    install: function (v, options) {
        v.prototype.$log.error('ConfirmPlugin will be deprecated in modul v.1.0');
        (v.prototype).$confirm = confirmFunction;
    }
};
export default ConfirmPlugin;
//# sourceMappingURL=confirm.js.map